meta {
  name: Create Reservation - Missing Fields
  type: http
  seq: 1
}

post {
  url: {{apiUrl}}/reservation
  body: json
  auth: none

headers {
  X-Api-Key: {{apiKey}}
}
}

body:json {
  {
    "Hotel": {
      "Id": {{sfHotel.Id}},
      "Code": "{{sfHotel.Code}}",
      "Name": "{{sfHotel.Name}}"
    },
    "RoomStay": {
      "CheckInDate": "2025-06-15",
      "CheckOutDate": "2025-06-20",
      "NumRooms": 1
    },
    "Guests": [
      {
        "PersonName": {
          "GivenName": "Test",
          "Surname": "Missing_{{testId}}"
        }
      }
    ],
    "status": "Confirmed"
  }
}

tests {
  test("Status code is 400", function() {
    expect(res.status).to.equal(400);
  });
  
  test("Error code is ValidationError", function() {
    expect(res.body).to.have.property("errorCode", "ValidationError");
  });
  
  test("Error message contains missing field details", function() {
    const errorMsg = res.body.errorMessage;
    expect(errorMsg).to.include("BookingInfo");
    expect(errorMsg).to.include("GuestCount");
    expect(errorMsg).to.include("Products");
  });
}
